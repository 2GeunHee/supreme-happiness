# IIS 설치 및 설정

### 1.IIS 설치

제어판 → 프로그램 제거 또는 변경 → Windows 기능 켜기/끄기

|                                |                                |
| :----------------------------: | :----------------------------: |
| ![img1](images/20211217/1.PNG) | ![img2](images/20211217/2.jpg) |

|                                |                                |                                                                                                                                 |
| :----------------------------: | :----------------------------: | :-----------------------------------------------------------------------------------------------------------------------------: |
| ![img3](images/20211217/3.jpg) | ![img4](images/20211217/4.jpg) | 인터넷 정보 서비스 → World Wide Web 서비스 → 응용 프로그램 개발 기능 <br>인터넷 정보 서비스 → 웹 관리 도구다음과 같이 설정한다. |

---

### 2.IIS 관리자 설정

<img src="images/20211217/5.jpg" alt="img5" width="60%" height="auto">

<br>

#### 2-1. 웹사이트 추가

사이트 이름 : wrestling<br>
실제 경로 : C:\Users\5N\Desktop\wrestling
| | |
| :--------------------: | :--------------------: |
| ![img6](images/6.jpg) | ![img7](images/7.jpg) |

<br>

#### 2-2. 사이트 바인딩 편집

기존 포트인 80에서 변경하는 이유 : 포트 충돌 우려가 있어서 변경하는 것을 추천

|                                |                                |                                  |
| :----------------------------: | :----------------------------: | :------------------------------: |
| ![img8](images/20211217/8.jpg) | ![img9](images/20211217/9.jpg) | ![img10](images/20211217/10.jpg) |

<br>

#### 2-3. 고급 설정

실제 경로로 지정한 곳이 해당 웹 루트 디렉터리가 된다.
실제 경로 : C:\Users\5N\Desktop\wrestling
| | |
| :--------------------: | :--------------------: |
| ![img11](images/20211217/11.jpg) | ![img12](images/20211217/12.jpg) |

<br>

#### 2-4. 기본 설정

고급 설정에서 수정하면 자동 반영된다.

애플리케이션 풀 : Classic .NET AppPool
실제 경로 : C:\Users\5N\Desktop\wrestling

|                                  |                                  |
| :------------------------------: | :------------------------------: |
| ![img13](images/20211217/13.jpg) | ![img14](images/20211217/14.jpg) |

<br>

#### 2-5 가상 디렉터리

별칭 : wrestling
실제 경로 : C:\Users\5N\Desktop\wrestling

<img src="images/20211217/15.jpg" alt="img15" width="60%" height="auto">

|                                  |                                  |
| :------------------------------: | :------------------------------: |
| ![img16](images/20211217/16.jpg) | ![img17](images/20211217/17.jpg) |

<br>

---

### 3. IIS에서 파일 불러오는 순서

3-1. 기본설정
①default.asp  
②default.html  
③index.asp  
④index.html

3-2. 별도의 설정
web.config파일에 defaultDocument를 통해 연결할 파일을 지정한다.
<img src="images/20211217/25.jpg" alt="img25" width="60%" height="auto">

---

### 4. 오류 및 해결방법

4-1. HTTP 오류 401.3 : 권한 관련

<img src="images/20211220/1오류1.jpg" alt="img26" width="60%" height="auto">

<br>
①IIS 관리자 → 디렉터리 검색 → 사용

|                                          |                                          |
| :--------------------------------------: | :--------------------------------------: |
| ![img27](images//20211220/2해결방법.jpg) | ![img28](images//20211220/3해결방법.jpg) |

<br>
②IIS 관리자 → 사용자 권한 편집 → 보안 → 편집 → 추가

|                                          |                                          |                                          |
| :--------------------------------------: | :--------------------------------------: | :--------------------------------------: |
| ![img29](images//20211220/4해결방법.jpg) | ![img30](images//20211220/5해결방법.jpg) | ![img31](images//20211220/6해결방법.jpg) |

|                                          |                                          |                                                                                                             |
| :--------------------------------------: | :--------------------------------------: | :---------------------------------------------------------------------------------------------------------: |
| ![img32](images//20211220/7해결방법.jpg) | ![img33](images//20211220/8해결방법.jpg) | 선택할 개체 이름을 입력하십시오 : users → 이름 확인 → 확인 <br> Users의 사용 권한 : 모든 권한 → 허용 → 적용 |

4-2. HTTP 오류 404.8 : hiddenSegment 섹션 관련

<img src="images//20211220/9오류2.jpg" alt="img34" width="60%" height="auto">

<br>
IIS 관리자 → 요청 필터링 → 숨겨진 세그먼트 → web.config → 제거

|                                           |                                           |
| :---------------------------------------: | :---------------------------------------: |
| ![img35](images//20211220/10해결방법.jpg) | ![img36](images//20211220/11해결방법.jpg) |

<img src="images//20211220/12해결방법.jpg" alt="img37" width="49%" height="auto">

<br>
4-3. HTTP 오류 404.7 : 요청 필터링 모듈 관련

<img src="images//20211220/13오류3.jpg" alt="img38" width="60%" height="auto">

<br>
IIS 관리자 → 요청 필터링 → 파일 이름 확장명 → .config → 제거

|                                           |                                           |
| :---------------------------------------: | :---------------------------------------: |
| ![img39](images//20211220/14해결방법.jpg) | ![img39](images//20211220/15해결방법.jpg) |

<br>
4-4. HTTP 오류 404.3 : 확장 구성 관련

<img src="images//20211220/16오류4.jpg" alt="img40" width="60%" height="auto">

<br>
①Windows 기능 켜기/끄기 → 인터넷 정보 서비스 → World Wide Web 서비스 → 응용 프로그램 개발 기능 → CGI 체크 → 확인

|                                           |                                           |
| :---------------------------------------: | :---------------------------------------: |
| ![img41](images//20211220/17해결방법.jpg) | ![img42](images//20211220/18해결방법.jpg) |

<br>
②IIS 관리자 → MIME 형식 → 추가 → 파일 이름 확장명 : * / MIME 형식 : application/unknown → 확인

|                                           |                                           |                                           |
| :---------------------------------------: | :---------------------------------------: | :---------------------------------------: |
| ![img43](images//20211220/19해결방법.jpg) | ![img44](images//20211220/20해결방법.jpg) | ![img45](images//20211220/21해결방법.jpg) |

<br>
4-5. 서버 개체, ASP 0177 (0x800401F3) : RyeolStringEncrypter 설치

|                                        |                                           |
| :------------------------------------: | :---------------------------------------: |
| ![img46](images//20211220/26오류6.jpg) | ![img47](images//20211220/26오류코드.jpg) |

①RyeolStringEncrypter를 다운 → C:\Windows\System32 위치에 RyeolStringEncrypter.dll 파일 이동

<img src="images//20211220/27해결방법.jpg" alt="img48" width="60%" height="auto">

<br>
② 명령 프롬프트 관리자 권한으로 실행하기 → regsvr32 C:\Windows\System32\RyeolStringEncrypter.dll 입력

|                                  |                                  |
| :------------------------------: | :------------------------------: |
| ![img49](images//20211221/4.jpg) | ![img50](images//20211221/5.jpg) |
